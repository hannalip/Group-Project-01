<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>What Do You Want to Eat?</title>

</head>

<body>
	<!-- <input type="text" id="zipcodeDiv">
	<button id="find-city" type="button">Search</button>
	</input> -->

	<!-- <button id="find-me">Show my location</button><br /> -->
	<p id="status"></p>
	<a id="map-link" target="_blank"></a>

	<!-- Script Tag -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script type="text/javascript">
		$(document).ready(function () {
			geoFindMe();
			// $("#find-city").on("click", function (event) {
			// 	event.preventDefault();
			// 	var zipcode = $("#zipcodeDiv").val();
			// 	$("#zipcode").val("");
			// 	getResturants(zipcode)
			// });
		});


		function geoFindMe() {

			const status = document.querySelector('#status');
			const mapLink = document.querySelector('#map-link');

			mapLink.href = '';
			mapLink.textContent = '';

			function success(position) {
				const latitude = position.coords.latitude;
				const longitude = position.coords.longitude;
				console.log(latitude);
				console.log(longitude);

				status.textContent = '';
				mapLink.href = `https://www.openstreetmap.org/#map=18/${latitude}/${longitude}`;
				// mapLink.textContent = `Latitude: ${latitude} °, Longitude: ${longitude} °`;
				console.log(mapLink.textContent)
				getResturants(longitude, latitude)
			}

			function error() {
				status.textContent = 'Unable to retrieve your location';
			}

			if (!navigator.geolocation) {
				status.textContent = 'Geolocation is not supported by your browser';
			} else {
				status.textContent = 'Locating…';
				navigator.geolocation.getCurrentPosition(success, error);
			}

		}
		
		function getResturants(longitude, latitude) {
			var usRestaurantMenus = {
				"async": true,
				"crossDomain": true,
				"url": "https://us-restaurant-menus.p.rapidapi.com/restaurants/search/geo?page=1&lon=" + longitude + "&lat=" + latitude + "&distance=1",
				"method": "GET",
				"headers": {
					"x-rapidapi-host": "us-restaurant-menus.p.rapidapi.com",
					"x-rapidapi-key": "db19f6c31fmsh74ab69ea63379d5p187630jsn004e83353fc9"
				}
			}
			$.ajax(usRestaurantMenus).done(function (response) {
				console.log(response);
			});
		};


	</script>
</body>

</html>